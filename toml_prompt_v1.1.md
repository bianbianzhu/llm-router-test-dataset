# 输入:

意图种类：{{args}}

# 输出:

1. 开发用数据集（25）<意图种类名称>_development.json
2. 测试用数据集（75）<意图种类名称>_test.json
3. 测试用数据集 - 松散 （75）<意图种类名称>_test_loose.json

**注意:**
完成每一步后，都必须更新 progress.md

## 步骤 0: 生成笔记

- 仿照例子和当前任务生成笔记 progress.md

## 步骤 1: 请根据以下指令生成一个 Markdown 格式的“定义文件”：

1.  **读取模板**: 从 `template.md` 文件中加载现有模板。
2.  **生成内容**:
    - 依据输入的**种类**（意图种类）和已加载的模板，生成 Markdown 内容。
    - 确保合理使用 Markdown 元素，包括标题（Headers）、引用块（Blockquotes）和无序列表（Bullet point lists）。
3.  **保存文件**: 将生成的 Markdown 内容保存到 `intents/<意图种类名称>.md`。文件命名应使用 `snake_case` 格式。

## 步骤 2: 检查并修正生成的 Markdown 文件

1. 请求用户检查生成的文件并手动修正。在提示中显式提供 Markdown 文件的**完整路径**
2. **完成确认**：并请求用户在完成检查和手动修正后，请回复“**完成**”以继续工作流。
   **注意**：任何其他回复将中断工作流。

## 步骤 3: 生成一个**松散定义文件**：

1.  **读取原定义文件**: 从指定地址读取`定义文件`的内容。
2.  **生成松散内容**: 根据原定义文件的 Markdown 内容，生成一个新的 Markdown 文件。新文件中的定义和示例应更具通用性和包容性，以模拟用户查询的多样性。
    - **目的**: 此文件旨在为生成更广泛的测试数据提供基础。
3.  **保存文件**: 将生成的 Markdown 内容保存到 `intents/<意图种类名称>_loose.md`。

## 步骤 4: 生成一个**开发用数据集**：

1.  **读取定义文件**: 从指定地址读取`定义文件`的内容。
2.  **生成数据**:
    - 根据定义文件中对意图的描述和提供的示例，生成 **25 条** 符合要求（符合描述，类似示例）的用户查询数据。
    - **意图**: 每条数据中的 `intent` 字段应填写当前意图的名称。
3.  **数据格式**: 生成的数据必须是 JSON 数组，每项包含 `id` (UUID)、`input` (生成的用户查询内容) 和 `intent` (当前意图名称)。
    ```json
    [
      {
        "id": "<uuid>",
        "input": "<生成的用户查询内容>",
        "intent": "<该意图名称>"
      }
    ]
    ```
4.  **保存文件**: 将生成的 JSON 数据保存到 `test_data/<意图种类名称>_development.json`。

## 步骤 5: 生成一个**测试用数据集**：

1.  **读取定义文件**: 从指定地址读取`定义文件`的内容。
2.  **生成数据**:
    - 根据定义文件中对意图的描述和提供的示例，生成 **75 条** 符合要求（符合描述，类似示例）的用户查询数据。
    - **意图**: 每条数据中的 `intent` 字段应填写当前意图的名称。
3.  **数据格式**: 生成的数据必须是 JSON 数组，每项包含 `id` (UUID)、`input` (生成的用户查询内容) 和 `intent` (当前意图名称)。
    ```json
    [
      {
        "id": "<uuid>",
        "input": "<生成的用户查询内容>",
        "intent": "<该意图名称>"
      }
    ]
    ```
4.  **保存文件**: 将生成的 JSON 数据保存到 `test_data/<意图种类名称>_test.json`。

**注意**：此数据集与开发用数据集的生成逻辑和格式完全相同，仅数量不同。

## 步骤 6: 生成一个**松散测试用数据集**：

1.  **读取松散定义文件**: 从指定地址读取`松散定义文件`的内容。
2.  **生成松散数据**:
    - 根据松散定义文件中对意图的描述和提供的示例，生成 **75 条** 更具通用性和多样性的用户查询数据。
    - **意图**: 每条数据中的 `intent` 字段应填写当前意图的名称。
3.  **数据格式**: 生成的数据必须是 JSON 数组，每项包含 `id` (UUID)、`input` (生成的用户查询内容) 和 `intent` (当前意图名称)。
    ```json
    [
      {
        "id": "<uuid>",
        "input": "<生成的用户查询内容（松散）>",
        "intent": "<该意图名称>"
      }
    ]
    ```
4.  **保存文件**: 将生成的 JSON 数据保存到 `test_data/<意图种类名称>_test_loose.json`。

## 步骤 7: 将生成的数据上传到 LangSmith

此步骤负责将先前步骤中生成的 `.json` 数据集上传到 LangSmith 平台。

1.  **指令核心**:

    - 你将使用预设的 `pnpm run create:dataset` 命令来执行上传。
    - **命令功能**: 此命令能将指定的 `_test.json` 或 `_test_loose.json` 文件中的数据，上传至 LangSmith 上的一个数据集中。如果目标数据集不存在，命令会自动创建它。

2.  **`pnpm run create:dataset` 命令参数详解**:

    - `<datasetName>` (必填):
      - 指定 LangSmith 中的数据集名称。
      - 如果 LangSmith 中不存在该名称的数据集，则会自动创建。如果存在，则会将数据添加到现有数据集中。
      - **现有数据集**: `intent_classification_dataset` (对应以`_test.json`结尾的数据文件) 和 `intent_classification_dataset_loose` (对应以`_test_loose.json`结尾的数据文件)。
    - `--fileName <前缀>` / `-f <前缀>` (可选):
      - 指定要上传的数据文件的前缀（例如，`faq` 对于 `faq_test.json`）。
      - 如果未提供，则将处理所有符合 `--type` 类型的 `.json` 文件。
        - 你应该使用从先前步骤中获取的意图种类名称作为前缀。
    - `--type <类型>` / `-t <类型>` (可选):

      - 指定数据集的类型：`test` (默认值) 或 `loose`。
      - 该类型决定了读取的文件后缀：`_test.json` 或 `_test_loose.json`。
      - 例如：`--type test` 会查找 `<fileName>_test.json`；`--type loose` 会查找 `<fileName>_test_loose.json`。

    **重要：**在不确定时，使用`pnpm run create:dataset --help`来查看该命令的使用方法

3.  **执行前确认**:
    在执行命令前，你必须通过提问，从用户处获取以下两个关键信息：

    - **问题 1 (关于数据集)**:
      > "请确认 LangSmith 的目标数据集。我们现有的数据集是：
      >
      > - `intent_classification_dataset` (用于标准测试数据)
      > - `intent_classification_dataset_loose` (用于松散测试数据)
      >
      > **直接回复`完成`**，即可将数据添加至上述对应的现有数据集。如果需要创建新数据集，请输入新数据集的名称。"
    - **逻辑**: 除非用户明确指示创建新数据集并提供名称，否则默认选择使用现有数据集。

    - **问题 2 (关于数据类型)**:
      > "请选择需要上传的数据类型：
      >
      > 1.  `test` (仅上传 `<意图种类名称>_test.json`)
      > 2.  `loose` (仅上传 `<意图种类名称>_test_loose.json`)
      > 3.  `both` (上传以上两种文件)
      >
      > 请输入选项 (1, 2, 或 3):"
    - **逻辑**:
      - 如果用户选择 `test`，执行 `pnpm run create:dataset <用户选择或默认数据集名称> --fileName <意图种类名称> --type test`。
      - 如果用户选择 `loose`，执行 `pnpm run create:dataset <用户选择或默认数据集名称> --fileName <意图种类名称> --type loose`。
      - 如果用户选择 `both`，则需要分别执行上述两个命令。

4.  **构建并执行命令**:
    严格根据用户的回复构建并执行命令。`<意图种类名称>` 从先前步骤中获取。

    - **场景 A: 用户选择 `test` (选项 1)**

      - **目标数据集**: `intent_classification_dataset` (或用户指定的新名称)。
      - **执行命令**:
        pnpm run create:dataset <目标数据集名称> -f <意图种类名称> --type test

    - **场景 B: 用户选择 `loose` (选项 2)**

      - **目标数据集**: `intent_classification_dataset_loose` (或用户指定的新名称)。
      - **执行命令**:
        pnpm run create:dataset <目标数据集名称> -f <意图种类名称> --type loose

    - **场景 C: 用户选择 `both` (选项 3)**
      - **重要**: 你需要**依次执行**以下两个命令。
      1.  **上传 `test` 数据**:
          pnpm run create:dataset intent_classification_dataset -f <意图种类名称> --type test
      2.  **上传 `loose` 数据**:
          pnpm run create:dataset intent_classification_dataset_loose -f <意图种类名称> --type loose
      - **注意**: 如果用户在问题 1 中要求创建新数据集，你需要与用户确认，是将两种类型的数据上传到**同一个新数据集**，还是为 `loose` 类型的数据创建一个独立的、带有 `_loose` 后缀的新数据集。**优先推荐后者**。

5.  **监控与验证**:
    - **监听终端输出**: 仔细检查命令执行后的返回信息。
    - **成功标志**: 成功的输出应包含 `dataset created successfully` 或类似信息，并提供数据集的名称（`name`）和 ID（`id`）。
    - **记录结果**: 成功后，必须在 `progress.md` 中更新文件生成进度，记录已上传的数据集。
    - **失败处理**: 如果命令执行失败，请分析终端返回的错误信息，定位问题，并向用户报告详细错误以进行调试。

---

progress.md 笔记格式

## 步骤

[x] 1. xxxxx
[ ] 2. yyyyy
[ ] 3. zzzzz
...

## 文件生成进度

[x] one.md
[ ] two.md
[ ] three.json
...

## 当前任务

读取`定义文件`内容...
